function [] = prop2018c()


%% 2nd of December,  2018

% consolidated 2.45GHz theory & measured data 
% for EEE414 propagation assignment


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% two-ray interference model derived from Sommer  %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% height above floor in metres
% this is set for 1metre
% measurmenets were done at 1.03 & 1.09metres
h1 = 1.00;

% wavelength in metres
l = 0.1223673;

% separation distances
dS = [1:0.01:50];

% freespace loss,  equation 1
Lfs = -20*log10( 4*pi*dS/l );

% separation distances,  coarse version
dS_c = [1 1.25 1.5 2 2.5 3 3.5 4:1:50];

% freespace loss,  equation 1,  coarse version
Lfs_c = -20*log10( 4*pi*dS_c/l );

%% relative permittivity of the floor  %%
er = 4.5;

%%%  NORMAL  %%%
% two-ray interference
dref = sqrt( dS.*dS + 4*h1.*h1 );

sinT = 2*h1./dref;

cosT = dS./dref;

phi = 2*pi* ( dS - dref )/l;

% reflection coefficient for normal polarisation
rc_norm_44 = ( sinT - sqrt( er - cosT.*cosT ) ) ./ ( sinT + sqrt( er - cosT.*cosT ) );

% 2-Ray Interfence (TRI) calculation
LtriN_44 = -20*log10( 4*pi*dS/l ./ abs( 1 + rc_norm_44.*exp( i*phi ) ) );



%%%  PARALLEL  %%%
% calculations for horizontal polarisation
dref2 = sqrt( dS.*dS + 4*h1.*h1 );
sinT2 = 2*h1./dref2;
cosT2 = dS./dref2;
phi2 = 2*pi* ( dS - dref2 )/l;

% reflection coefficient for parallel polarisation
rc_para_44 = ( -er*sinT2 + sqrt( er - cosT2.*cosT2 ) ) ./ ( er*sinT2 + sqrt( er - cosT2.*cosT2 ) );
%% is the first - sign wrong?
%%  %% was:  rc_para_44 = ( -er*sinT2 + sqrt( er - cosT2.*cosT2 ) ) ./ ( er*sinT2 + sqrt( er - cosT2.*cosT2 ) );

% 2-Ray Interfence (TRI) calculation
LtriP_44 = -20*log10( 4*pi*dS/l ./ abs( 1 - rc_para_44.*exp( i*phi2 ) ) );
%% negated the reflection coefficient


%% relative permittivity of the floor  %%
er = 7.5;

%%%  NORMAL  %%%
% two-ray interference
dref = sqrt( dS.*dS + 4*h1.*h1 );

sinT = 2*h1./dref;

cosT = dS./dref;

phi = 2*pi* ( dS - dref )/l;

% reflection coefficient for normal polarisation
rc_norm_75 = ( sinT - sqrt( er - cosT.*cosT ) ) ./ ( sinT + sqrt( er - cosT.*cosT ) );

% 2-Ray Interfence (TRI) calculation
LtriN_75 = -20*log10( 4*pi*dS/l ./ abs( 1 + rc_norm_75.*exp( i*phi ) ) );

%%%  PARALLEL  %%%
% calculations for horizontal polarisation
dref2 = sqrt( dS.*dS + 4*h1.*h1 );
sinT2 = 2*h1./dref2;
cosT2 = dS./dref2;
phi2 = 2*pi* ( dS - dref2 )/l;

% reflection coefficient for parallel polarisation
rc_para_75 = ( -er*sinT2 + sqrt( er - cosT2.*cosT2 ) ) ./ ( er*sinT2 + sqrt( er - cosT2.*cosT2 ) );
%% %% was:  rc_para_75 = ( -er*sinT2 + sqrt( er - cosT2.*cosT2 ) ) ./ ( er*sinT2 + sqrt( er - cosT2.*cosT2 ) );

% 2-Ray Interfence (TRI) calculation
LtriP_75 = -20*log10( 4*pi*dS/l ./ abs( 1 - rc_para_75.*exp( i*phi2 ) ) );


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  PEC  %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% TRI calculation using reflection coefficient 1 for horizontal polarisation incident on PEC floor
LtriPEC_P = -20*log10( 4*pi*dS/l ./ abs( 1 +1.*exp( i*phi2 ) ) );

LtriPEC_N = -20*log10( 4*pi*dS/l ./ abs( 1 -1.*exp( i*phi2 ) ) );


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% old data taken from prop06.m
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Tx power was 13dBm		
% frequency was 2.45GHz	
% 2.45GHz propagation measurements down the 4th floor corridor
% broadcast 13dBm

% vertical polarisation from October 9th		
v2014 = [1	-9.8	-9.5
1.1	-10.5	-10.2
1.2	-11.4	-11.1
1.3	-12.9	-12.7
1.4	-11.6	-11.2
1.5	-13.9	-13.7
1.6	-15.02	-14.8
1.7	-14.5	-14.1
1.8	-15.6	-14.2
1.9	-15.4	-14.7
2	-17.2	-16.6
2.1	-16.6	-15.72
2.2	-15.9	-15.4
2.3	-17.7	-16.8
2.4	-17.2	-16.9
2.5	-18.2	-17.6
2.6	-19.2	-18.8
2.7	-18.7	-18.2
2.8	-18.2	-17.7
2.9	-19.2	-18.7
3	-18.7	-18.2
4	-20.2	-19.2
4.4	-26.7	-25.9
4.5	-30	-28
4.6	-30	-29
4.7	-25.3	-24.7
5	-20.9	-20.4
6	-18.6	-18.4
7	-23	-21
8	-21.4	-20.9
9	-36	-34
10	-29.7	-29.1
12	-37	-34
14	-35.9	-34
16	-34	-32
17	-24.9	-24
18	-24.7	-24.2
20	-27.8	-27.2
24	-23.6	-22.8
28	-28.4	-27.7];



%% 2015 data from EE building 4th floor
% FAXE beer can antennas
% broadcast 20dBm
% m	min (*-1)	max (*-1)
v2015 =[1.00	12.53	12.50
1.10	14.80	14.71
1.20	14.06	14.02
1.30	14.90	14.57
1.40	15.69	15.61
1.50	15.79	15.73
1.60	16.53	16.47
1.70	17.80	17.76
1.80	18.23	18.21
1.90	17.47	17.42
2.00	18.78	18.65
2.10	20.62	20.51
2.20	20.78	20.75
2.30	20.26	20.22
2.40	19.48	19.40
2.50	20.67	20.64
2.60	19.57	19.51
2.70	21.45	21.41
2.80	23.62	23.51
2.90	20.96	20.92
3.00	24.20	24.02
3.50	22.68	22.54
4.00	23.10	22.84
4.10	27.40	27.25
4.20	39.40	37.84
4.30	32.15	32.06
4.40	27.92	27.49
4.50	28.52	28.04
4.60	39.92	38.88
4.70	26.06	25.64
4.80	21.00	20.96
4.90	19.89	19.83
5.00	22.60	22.50
6.00	21.73	21.58
7.00	24.26	24.21
8.00	33.70	32.57
9.00	32.90	32.80
9.50	30.94	30.86
9.60	34.55	34.34
9.70	33.74	33.46
9.80	29.26	38.66
9.90	42.27	41.94
10.00	41.10	40.57
10.10	40.03	40.01
10.20	30.65	30.49
10.30	20.56	29.32
10.40	32.90	32.84
10.50	31.62	31.40
11.00	31.43	31.40
12.00	29.40	29.37
14.00	31.93	31.73
15.00	29.69	29.63
16.00	42.31	42.08
18.00	36.00	35.79
20.00	31.60	31.55
22.00	43.27	43.07
24.00	29.47	29.35
26.00	32.73	32.71
28.00	36.10	35.46
30.00	33.55	33.47];


v2015(:,2) = -1 * v2015(:,2);
v2015(:,3) = -1 * v2015(:,3);



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 2016 measured data %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% measured on centre line of CG13W
% walls & ceiling assumed not to be significant reflecting surfaces

% Noise Level:	-56.9
% Height:	113.5 (cm)
% Signal Frequency	2.45 GHz
%%% this was 10cm higher than 2017 data %%%

% Distance (m)	Strength (dBm)

% 0.5	-10.37
expt2016 = [1	-13.63
1.5	-17.33
2	-19.4
2.5	-21.75
3	-23.05
3.5	-24.82
4	-25.94
4.5	-27.37
5	-29.27
5.1	-27.23
5.2	-29.04
5.3	-27.9
5.4	-28.68
5.5	-27.78
5.6	-28.27
5.7	-29.42
5.8	-29.94
5.9	-30.82
6	-31.58
6.1	-30.96
6.2	-29.23
6.3	-30.05
6.4	-30.56
6.5	-32.06
6.6	-32.56
6.7	-32.34
6.8	-31.62
6.9	-30.42
7	-31.63
7.1	-29.73
7.2	-29.85
7.3	-30.65
7.4	-29.69
7.5	-29.87
7.6	-28.81
7.7	-29.33
7.8	-30.62
7.9	-30.42
8	-32.36
8.1	-31.35
8.2	-31.2
8.3	-32.4
8.4	-31.6
8.5	-32.7
8.6	-33.2
8.7	-32.4
8.8	-33.7
8.9	-32.1
9	-35.5
9.1	-33.6
9.2	-36.1
9.3	-40.9
9.4	-40.08
9.5	-34.41
9.6	-37.75
9.7	-35.81
9.8	-35.58
9.9	-34.35
10	-34.53
10.1	-35.86
10.2	-34.12
10.3	-34.51
10.4	-33.25
10.5	-36.4
10.6	-36.2
10.7	-34.5
10.8	-36.56
10.9	-35.81
11	-35.58
11.1	-32.91
11.2	-31.37
11.3	-31.91
11.4	-34.7
11.5	-34.38
11.6	-35.47
11.7	-33.71
11.8	-31.88
11.9	-32.3
12	-32.91
12.1	-33.19
12.2	-33.45
12.3	-32.35
12.4	-32.33
12.5	-33.8
13	-31.6
13.5	-33
14	-39.15
14.5	-41.13
15	-35.43
15.5	-39.43
16	-39.15
16.5	-38.1
17	-42.52
17.5	-45.56
18	-46.28
18.5	-41.4
19	-44.98
19.5	-48.5
20	-51.3
20.5	-42.95
21	-49.3
21.5	-42.12
22	-47.52
22.5	-51.39
23	-40.88
23.5	-47.76
24	-40.12
24.5	-38.9
25	-44.15
25.5	-42.41
26	-43.13
26.5	-36.88
27	-36.13
27.5	-48.1
28	-45.86
28.5	-38.51
29	-38.1
29.5	-43.76
30	-42.85];


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 2017 measured data %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% measured on centre line of CG13W
% walls & ceiling assumed not to be significant reflecting surfaces
% same location as was used in 2016

% Noise Level:	
% Height:	 (cm)
% Signal Frequency	2.45 GHz
%%% this was 10cm lower than 2016 data %%%

% Distance (m)	Strength (dBm)
% 50	-9.79
expt2017 = [100	-15.63
150	-16.64
200	-21.72
250	-22.53
300	-24.57
350	-25.46
400	-27.16
450	-28.24
500	-29.5
550	-32.37
600	-30.09
650	-29.03
700	-29.4
750	-31.34
760	-32.71
770	-33.81
780	-38.9
790	-37.35
800	-36.81
850	-38.32
900	-35.61
950	-35.4
1000	-34.4
1050	-33.9
1100	-35.01
1150	-34.25
1200	-38.12
1250	-37.46
1300	-35.69
1350	-36.79
1400	-39.12
1450	-41.62
1500	-44.32
1550	-39.2
1600	-39.09
1650	-45.32
1660	-46.93
1670	-45.05
1680	-44.65
1690	-41.47
1700	-43.73
1750	-46.08
1800	-47.62
1850	-46.42
1900	-52.56
1950	-46.58
2000	-49.6
2050	-43.53
2100	-38.47
2150	-44.28
2200	-40.69
2250	-42.12
2300	-48.02
2350	-50.16
2400	-41.82
2450	-52.73
2500	-45.82
2550	-43.94
2600	-40.58
2650	-40.08
2700	-43.72
2750	-38.46
2800	-42.13
2850	-47.96
2900	-42.59
2950	-38.31
3000	-39.65
3050	-41.72
3100	-42.5
3150	-44.36
3200	-40.28
3250	-35.43
3300	-42.42
3350	-38.73
3400	-37.9];


% convert positions to metres,  where required
expt2017(:,1) = expt2017(:,1) * 1e-2;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 2018 measured data %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% measured in EE Building ground floor corridor
% 25th of October,  2018

% Noise Level:	
% Height:	 (cm)
% Signal Frequency	2.45 GHz
% vertical polarisation

% Distance (m)	Strength (dBm)
expt2018a = [1	-15.2	-14.9
1.5	-19.9	-19.5
2	-20.3	-19.7
2.5	-22.6	-22.1
3	-23.5	-22.7
3.5	-25	-24.4
4	-26.5	-26.2
4.5	-28.6	-27.9
5	-27.5	-27.3
5.5	-30	-28.7
6	-32.3	-31.6
6.5	-32.4	-31.4
7	-30.2	-30.1
7.5	-31.8	-31.1
8	-31.2	-30.3
8.5	-36.2	-35.1
9	-46	-43.5
9.5	-35.7	-35.2
10	-31.6	-31.3
10.5	-32.6	-32.1
11	-34.7	-34.2
11.5	-33.9	-33.2
12	-34.5	-34.2
12.5	-36.8	-36.2
13	-29.7	-29.1
13.5	-34.7	-34.4
14	-36.8	-36.6
14.5	-35.6	-35.1
15	-35.5	-35.1
15.5	-43.3	-42.9
16	-34.1	-33.7
16.5	-31.6	-31.3
17	-38.8	-38.2
17.5	-46.6	-46.2
18	-42.7	-42.2
18.5	-50.5	-48.5
19	-47.3	-46.7
19.5	-36.4	-36
20	-44.3	-43.6
20.5	-46.5	-44.9
21	-40.8	-40.4
21.5	-44.2	-43.3
22	-39.8	-39.1
22.5	-48.6	-47.1
23	-41.5	-39.8
23.5	-40.8	-40.1
24	-38.4	-37.5
24.5	-42.8	-42.1
25	-45.8	-44.8
25.5	-42.3	-41.5
26	-36.2	-35.2
26.5	-36.4	-35.5
27	-41.4	-39.8
27.5	-48	-47
28	-41.7	-40.8
28.5	-39.4	-38.5
29	-42.3	-41.9
29.5	-34.8	-34.5
30	-32.2	-32.1];


% measured in EE Building ground floor corridor
% 8th of November,  2018

% Noise Level:	
% Height:	 (cm)
% Signal Frequency	2.45 GHz
% horizontal polarisation


% 0.5	-8.05
expt2018b = [1	-14
1.5	-18.04
2	-18.36
2.5	-19.82
3	-22.27
3.5	-31.62
4	-21.67
4.5	-32.39
5	-24.67
5.5	-23.96
6	-34.04
6.5	-27.96
7	-28.07
7.5	-22.9
8	-29.76
8.5	-26.74
9	-40.27
9.5	-40.12
10	-37.16
10.5	-29.5
11	-30.49
11.5	-28.64
12	-33.04
12.5	-30.18
13	-31.67
13.5	-29.62
14	-30.79
14.5	-30.33
15	-35.02
15.5	-34.86
16	-40.22
16.5	-37.66
17	-37.89
17.5	-35.7
18	-46.27
18.5	-39.52
19	-38.18
19.5	-50.08
20	-38.45
20.5	-34.17
21	-32.89
21.5	-39.98
22	-44.62
22.5	-43.61
23	-35.51
23.5	-34.13
24	-33.38
24.5	-35.65
25	-39.56
25.5	-40.13
26	-37.09
26.5	-31.43
27	-31.31
27.5	-32.45
28	-30.94
28.5	-32.15
29	-32.94
29.5	-33.27
30	-31.97
30.5	-31.87
31	-32.33
31.5	-32.44
32	-33.07
32.5	-32.3
33	-31.92
33.5	-32.64
34	-33.65
34.5	-34.17
35	-37.03
35.5	-40.03
36	-36.98
36.5	-34.63
37	-42.77
37.5	-41.92
38	-43.21
38.5	-44.89
39	-38.63
39.5	-37.89
40	-33.98
40.5	-51.67
41	-33.41
41.5	-33.89
42	-31.47
42.5	-32.67
43	-31.98
43.5	-31.14
44	-33.04
44.5	-31.52
45	-30.76
45.5	-39.88
46	-40.02
46.5	-36.16];

expt2018b_fine = [15	-34.07
15.2	-30.22
15.4	-30.84
15.6	-36.48
15.8	-38.5
16	-40.62
16.2	-36.62
16.4	-34.67
16.6	-33.01
16.8	-34.55
17	-37.3];


% measured in EE Building ground floor corridor
% 22nd of November,  2018

% Noise Level:	
% Height:	 (cm)
% Signal Frequency	2.45 GHz
% vertical polarisation
expt2018c = [1	-12
1.5	-16
2	-18
2.5	-20
3	-21
3.5	-22.56
4	-23.5
4.5	-26.09
5	-23.79
5.5	-27.23
6	-30.45
6.5	-29.57
7	-25.53
7.5	-28.6
8	-29.8
8.5	-33.05
9	-43.77
10	-38.44
10.5	-29.17
11	-33
11.5	-27
12	-30
12.5	-31
13	-27.56
13.5	-32.67
14	-33.5
14.5	-34.09
15	-40.39
15.5	-35.85
16	-31.69
16.5	-42.67
17	-37.38
17.5	-37.46
18	-45.46
18.5	-36.76
19	-41
19.5	-38.63
20	-38.96
20.5	-37.61
21	-33.44
21.5	-33.9
22	-34.4
22.5	-40.69
23	-35.74
23.5	-37.54
24	-31.78
24.5	-47.59
25	-41.03
25.5	-34.93
26	-30.23
26.5	-31.64
27	-36.45
27.5	-38.94
28	-37.35
28.5	-33.46
29	-32.96
29.5	-31.53
30	-27.6
30.5	-29.23
31	-28.96
31.5	-30.86
32	-31.54
32.5	-29.47
33	-29.77
33.5	-30.25
34	-34.54
34.5	-33.63
35	-34.83
35.5	-39.23
36	-43.34
36.5	-35.39
37	-49.93
37.5	-43.32
38	-45.43
38.5	-41.39
39	-42.93
39.5	-47.67
40	-39.84
40.5	-43.39
41	-41.04
41.5	-37.42
42	-35.47
42.5	-40.92
43	-42.64
43.5	-44.76
44	-40.71
44.5	-35.98
45	-36.27
45.5	-34.64
46	-35.44
46.5	-36.85
47	-32.45
47.5	-37.63
48	-37.12
48.5	-38.36
49	-35.57
49.5	-34.04
50	-33.46];



% Noise Level:	
% Height:	 (cm)
% Signal Frequency	10.25 GHz
% vertical polarisation
expt2018d = [1	-9
1.5	-11
2	-13
2.5	-17.61
3	-15.16
3.5	-22.63
4	-23.28
4.5	-21.33
5	-27.2
5.5	-21.62
6	-19.1
6.5	-30.2
7	-29.75
7.5	-21.56
8	-28.7
8.5	-21.12
9	-40.28
9.5	-22.98
10	-40.28
10.5	-40.28
11	-40.28];


%%%   %%%   %%%   %%%   %%%

% graph all the 2.45GHz vertically polarised measured data

figure
plot(expt2016(:,1),expt2016(:,2)-expt2016(1,2),expt2017(:,1),expt2017(:,2)-expt2017(1,2),...
    expt2018a(:,1),expt2018a(:,2)-expt2018a(1,2),expt2018c(:,1),expt2018c(:,2)-expt2018c(1,2),'LineWidth',2)
xlabel('Position (m)')
ylabel('Normalised RX power (dB)')
grid on
axis([0 50 -35 0])
title('vertical expt results')
strlst={'2016','2017','2018 A','2018 C'};
legend(strlst)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% FEKO simulation results
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%   %%%  beer cans  %%%  %%%
%	vertical polarisation
%% 	no gnd	PEC	PMC	er=4.5	er=7.5
%% 5.00E+02	-1.875207437E+01	-1.866002141E+01	-1.886511673E+01	-1.872335865E+01	-1.871068305E+01
beer_V = [1.00E+03	-2.468248234E+01	-2.546464610E+01	-2.395014741E+01	-2.491981645E+01	-2.499924302E+01
1.50E+03	-2.817733381E+01	-2.950620696E+01	-2.698208678E+01	-2.855664864E+01	-2.869256294E+01
2.00E+03	-3.066250771E+01	-2.908673179E+01	-3.235204916E+01	-3.026334423E+01	-3.009063209E+01
2.50E+03	-3.259229453E+01	-3.003050727E+01	-3.622055844E+01	-3.204622796E+01	-3.175134535E+01
3.00E+03	-3.417036375E+01	-3.266620162E+01	-3.436605496E+01	-3.405340287E+01	-3.391883020E+01
3.50E+03	-3.550555520E+01	-4.019443711E+01	-3.200687387E+01	-3.582167225E+01	-3.627400089E+01
4.00E+03	-3.666272903E+01	-3.272325131E+01	-4.259706536E+01	-3.650874394E+01	-3.601175136E+01
4.50E+03	-3.768374035E+01	-3.898508274E+01	-3.432244140E+01	-3.760241206E+01	-3.791366423E+01
5.00E+03	-3.859717167E+01	-3.916631001E+01	-3.530034240E+01	-3.846593674E+01	-3.875422213E+01
5.50E+03	-3.942348611E+01	-3.457676371E+01	-4.922191246E+01	-4.004230617E+01	-3.935208600E+01
6.00E+03	-4.017802875E+01	-3.683878759E+01	-3.970686782E+01	-4.038634621E+01	-4.018736082E+01
6.50E+03	-4.087223281E+01	-4.556976844E+01	-3.610388107E+01	-3.991581993E+01	-4.047519288E+01
7.00E+03	-4.151511709E+01	-4.788804108E+01	-3.651259979E+01	-4.031505621E+01	-4.090947386E+01
7.50E+03	-4.211368259E+01	-4.013384652E+01	-3.935633756E+01	-4.181320406E+01	-4.198440824E+01
8.00E+03	-4.267361463E+01	-3.791853926E+01	-4.528483944E+01	-4.398737774E+01	-4.349373185E+01
8.50E+03	-4.319956419E+01	-3.765509101E+01	-6.190107696E+01	-4.567942498E+01	-4.473302412E+01
9.00E+03	-4.369550109E+01	-3.853871190E+01	-4.809351110E+01	-4.564421710E+01	-4.501409058E+01
9.50E+03	-4.416464392E+01	-4.032428661E+01	-4.320006501E+01	-4.458866519E+01	-4.453144858E+01
1.00E+04	-4.460981649E+01	-4.304029969E+01	-4.108083821E+01	-4.361324124E+01	-4.391715906E+01
1.05E+04	-4.503322533E+01	-4.707702745E+01	-4.015040761E+01	-4.304010323E+01	-4.350970725E+01
1.10E+04	-4.543696025E+01	-5.397910438E+01	-3.990245851E+01	-4.285978027E+01	-4.338863485E+01
1.15E+04	-4.582274560E+01	-6.844517313E+01	-4.010993881E+01	-4.300803001E+01	-4.353999811E+01
1.20E+04	-4.619209772E+01	-5.388080656E+01	-4.065409149E+01	-4.342641259E+01	-4.392951806E+01
1.25E+04	-4.654641387E+01	-4.913944529E+01	-4.146942061E+01	-4.407141768E+01	-4.452424522E+01
1.30E+04	-4.688686177E+01	-4.664272322E+01	-4.252185767E+01	-4.491296439E+01	-4.529749809E+01
1.35E+04	-4.721444375E+01	-4.513110553E+01	-4.379986260E+01	-4.593114335E+01	-4.622846065E+01
1.40E+04	-4.753012262E+01	-4.417667552E+01	-4.531243532E+01	-4.711343146E+01	-4.729988598E+01
1.45E+04	-4.783472889E+01	-4.358067539E+01	-4.709256455E+01	-4.845028866E+01	-4.849442512E+01
1.50E+04	-4.812899982E+01	-4.323396587E+01	-4.920915505E+01	-4.992905811E+01	-4.978800252E+01
1.55E+04	-4.841366855E+01	-4.306987952E+01	-5.179697624E+01	-5.152041013E+01	-5.113946867E+01
1.60E+04	-4.868922643E+01	-4.304466541E+01	-5.514076462E+01	-5.315121456E+01	-5.247389751E+01
1.65E+04	-4.895638643E+01	-4.312819643E+01	-5.997922192E+01	-5.466043354E+01	-5.366696549E+01
1.70E+04	-4.921556442E+01	-4.329881227E+01	-6.949424436E+01	-5.577668040E+01	-5.455346910E+01
1.75E+04	-4.946717721E+01	-4.354053627E+01	-7.046145924E+01	-5.623439786E+01	-5.499598084E+01
1.80E+04	-4.971176384E+01	-4.384138240E+01	-6.162637865E+01	-5.601583669E+01	-5.498059225E+01
1.85E+04	-4.994963284E+01	-4.419215839E+01	-5.769228342E+01	-5.536694974E+01	-5.462563613E+01
1.90E+04	-5.018114058E+01	-4.458573316E+01	-5.527370403E+01	-5.455882410E+01	-5.409031030E+01
1.95E+04	-5.040666164E+01	-4.501649499E+01	-5.359826265E+01	-5.375382387E+01	-5.349800516E+01
2.00E+04	-5.062647579E+01	-4.548013285E+01	-5.236427235E+01	-5.302128412E+01	-5.292006477E+01
2.05E+04	-5.084081959E+01	-4.597321877E+01	-5.142223009E+01	-5.238161454E+01	-5.239021547E+01
2.10E+04	-5.105007937E+01	-4.649321037E+01	-5.068700529E+01	-5.183436180E+01	-5.192071212E+01
2.15E+04	-5.125436805E+01	-4.703810840E+01	-5.010536976E+01	-5.137144551E+01	-5.151313461E+01
2.20E+04	-5.145397442E+01	-4.760658462E+01	-4.964178565E+01	-5.098282340E+01	-5.116409794E+01
2.25E+04	-5.164910497E+01	-4.819769403E+01	-4.927142046E+01	-5.065878306E+01	-5.086852283E+01
2.30E+04	-5.183991470E+01	-4.881088105E+01	-4.897611301E+01	-5.039052338E+01	-5.062076143E+01
2.35E+04	-5.202664603E+01	-4.944608801E+01	-4.874237709E+01	-5.017052307E+01	-5.041549455E+01
2.40E+04	-5.220943284E+01	-5.010364750E+01	-4.855964225E+01	-4.999227060E+01	-5.024762002E+01
2.45E+04	-5.238849106E+01	-5.078420897E+01	-4.841983026E+01	-4.985024215E+01	-5.011284388E+01
2.50E+04	-5.256389939E+01	-5.148885629E+01	-4.831629031E+01	-4.973978600E+01	-5.000720612E+01
2.55E+04	-5.273584997E+01	-5.221911776E+01	-4.824374620E+01	-4.965688002E+01	-4.992733811E+01
2.60E+04	-5.290443534E+01	-5.297696866E+01	-4.819780483E+01	-4.959812444E+01	-4.987019204E+01
2.65E+04	-5.306981656E+01	-5.376500094E+01	-4.817496820E+01	-4.956066694E+01	-4.983326315E+01
2.70E+04	-5.323214929E+01	-5.458640387E+01	-4.817210473E+01	-4.954193852E+01	-4.981422410E+01
2.75E+04	-5.339146029E+01	-5.544529339E+01	-4.818670064E+01	-4.953979542E+01	-4.981114440E+01
2.80E+04	-5.354790982E+01	-5.634666274E+01	-4.821659839E+01	-4.955235318E+01	-4.982224593E+01
2.85E+04	-5.370163450E+01	-5.729697213E+01	-4.825989302E+01	-4.957795022E+01	-4.984598505E+01
2.90E+04	-5.385264620E+01	-5.830435467E+01	-4.831493305E+01	-4.961514739E+01	-4.988103732E+01
2.95E+04	-5.400104280E+01	-5.937929096E+01	-4.838049467E+01	-4.966276282E+01	-4.992624534E+01
3.00E+04	-5.414699255E+01	-6.053569320E+01	-4.845524308E+01	-4.971959620E+01	-4.998050163E+01
3.05E+04	-5.429052112E+01	-6.179228042E+01	-4.853815112E+01	-4.978469334E+01	-5.004289726E+01
3.10E+04	-5.443172207E+01	-6.317510896E+01	-4.862830045E+01	-4.985719789E+01	-5.011258649E+01
3.15E+04	-5.457065598E+01	-6.472190323E+01	-4.872478420E+01	-4.993631277E+01	-5.018884293E+01
3.20E+04	-5.470736787E+01	-6.649023472E+01	-4.882704897E+01	-5.002137281E+01	-5.027097712E+01
3.25E+04	-5.484202683E+01	-6.857420553E+01	-4.893436553E+01	-5.011176158E+01	-5.035844839E+01
3.30E+04	-5.497458293E+01	-7.114370335E+01	-4.904615709E+01	-5.020696602E+01	-5.045062803E+01
3.35E+04	-5.510515649E+01	-7.455660126E+01	-4.916192928E+01	-5.030640828E+01	-5.054712221E+01
3.40E+04	-5.523383867E+01	-7.980400429E+01	-4.928122340E+01	-5.040972027E+01	-5.064749584E+01
3.45E+04	-5.536058607E+01	-9.227183769E+01	-4.940364717E+01	-5.051643489E+01	-5.075122830E+01
3.50E+04	-5.548554064E+01	-8.501155450E+01	-4.952880577E+01	-5.062621525E+01	-5.085813617E+01];


% convert position to metres
beer_V(:,1) = beer_V(:,1) * 1e-3;


%%%   %%%  beer cans  %%%  %%%

%% horizontal polarisation
% horizontal	no gnd	PEC	er=4.5	er=7.5
% 5.00E+02	-1.875207437E+01	-1.875964005E+01	-1.875859515E+01	-1.875927316E+01
beer_H = [1.00E+03	-2.468248234E+01	-2.419810213E+01	-2.448725239E+01	-2.443583248E+01
1.50E+03	-2.817733381E+01	-2.719239490E+01	-2.773989640E+01	-2.763742032E+01
2.00E+03	-3.066250771E+01	-3.212684401E+01	-3.138043301E+01	-3.152886890E+01
2.50E+03	-3.259229453E+01	-3.604856132E+01	-3.422267620E+01	-3.456325413E+01
3.00E+03	-3.417036375E+01	-3.403838533E+01	-3.435355164E+01	-3.432091893E+01
3.50E+03	-3.550555520E+01	-3.207317888E+01	-3.334759071E+01	-3.306061867E+01
4.00E+03	-3.666272903E+01	-4.197841524E+01	-3.992564692E+01	-4.039874196E+01
4.50E+03	-3.768374035E+01	-3.446360338E+01	-3.559663708E+01	-3.533840863E+01
5.00E+03	-3.859717167E+01	-3.516963636E+01	-3.633780797E+01	-3.607016301E+01
5.50E+03	-3.942348611E+01	-4.841586949E+01	-4.508803364E+01	-4.584647593E+01
6.00E+03	-4.017802875E+01	-3.994965373E+01	-4.054068221E+01	-4.043318594E+01
6.50E+03	-4.087223281E+01	-3.616041046E+01	-3.725634041E+01	-3.698678326E+01
7.00E+03	-4.151511709E+01	-3.648360722E+01	-3.756157114E+01	-3.729485123E+01
7.50E+03	-4.211368259E+01	-3.924823879E+01	-4.017224461E+01	-3.995628980E+01
8.00E+03	-4.267361463E+01	-4.502717355E+01	-4.536853975E+01	-4.534972258E+01
8.50E+03	-4.319956419E+01	-6.098366506E+01	-5.326721669E+01	-5.465335382E+01
9.00E+03	-4.369550109E+01	-4.836577290E+01	-4.824188338E+01	-4.834616085E+01
9.50E+03	-4.416464392E+01	-4.331827928E+01	-4.396056439E+01	-4.381451297E+01
1.00E+04	-4.460981649E+01	-4.114289527E+01	-4.190131128E+01	-4.171226431E+01
1.05E+04	-4.503322533E+01	-4.018182625E+01	-4.095606016E+01	-4.075870316E+01
1.10E+04	-4.543696025E+01	-3.991365650E+01	-4.067603688E+01	-4.048024838E+01
1.15E+04	-4.582274560E+01	-4.010614243E+01	-4.084671811E+01	-4.065622328E+01
1.20E+04	-4.619209772E+01	-4.063815216E+01	-4.135276619E+01	-4.116930636E+01
1.25E+04	-4.654641387E+01	-4.144283988E+01	-4.212936430E+01	-4.195392231E+01
1.30E+04	-4.688686177E+01	-4.248527242E+01	-4.314177402E+01	-4.297542011E+01
1.35E+04	-4.721444375E+01	-4.375320170E+01	-4.437718986E+01	-4.422110511E+01
1.40E+04	-4.753012262E+01	-4.525471178E+01	-4.584173094E+01	-4.569807274E+01
1.45E+04	-4.783472889E+01	-4.702172897E+01	-4.756318064E+01	-4.743564010E+01
1.50E+04	-4.812899982E+01	-4.912113999E+01	-4.959911340E+01	-4.949521381E+01
1.55E+04	-4.841366855E+01	-5.168383791E+01	-5.205681370E+01	-5.199330405E+01
1.60E+04	-4.868922643E+01	-5.498449826E+01	-5.513638357E+01	-5.515818441E+01
1.65E+04	-4.895638643E+01	-5.972627292E+01	-5.920854243E+01	-5.947445883E+01
1.70E+04	-4.921556442E+01	-6.881382320E+01	-6.444167254E+01	-6.568788517E+01
1.75E+04	-4.946717721E+01	-7.109220551E+01	-6.531399086E+01	-6.673431972E+01
1.80E+04	-4.971176384E+01	-6.185034077E+01	-6.103176372E+01	-6.135974373E+01
1.85E+04	-4.994963284E+01	-5.782058788E+01	-5.778679846E+01	-5.784596520E+01
1.90E+04	-5.018114058E+01	-5.536003192E+01	-5.555989979E+01	-5.553295406E+01
1.95E+04	-5.040666164E+01	-5.366087261E+01	-5.395454914E+01	-5.389182682E+01
2.00E+04	-5.062647579E+01	-5.241158906E+01	-5.274879185E+01	-5.266889777E+01
2.05E+04	-5.084081959E+01	-5.145887959E+01	-5.181736871E+01	-5.172857809E+01
2.10E+04	-5.105007937E+01	-5.071571632E+01	-5.108427393E+01	-5.099082774E+01
2.15E+04	-5.125436805E+01	-5.012793585E+01	-5.050043119E+01	-5.040467185E+01
2.20E+04	-5.145397442E+01	-4.965948359E+01	-5.003234542E+01	-4.993557207E+01
2.25E+04	-5.164910497E+01	-4.928508499E+01	-4.965614376E+01	-4.955923154E+01
2.30E+04	-5.183991470E+01	-4.898653481E+01	-4.935432593E+01	-4.925778526E+01
2.35E+04	-5.202664603E+01	-4.874994867E+01	-4.911365363E+01	-4.901789443E+01
2.40E+04	-5.220943284E+01	-4.856485600E+01	-4.892390639E+01	-4.882912028E+01
2.45E+04	-5.238849106E+01	-4.842292113E+01	-4.877706309E+01	-4.868335742E+01
2.50E+04	-5.256389939E+01	-4.831755333E+01	-4.866652429E+01	-4.857404003E+01
2.55E+04	-5.273584997E+01	-4.824343742E+01	-4.858711757E+01	-4.849589684E+01
2.60E+04	-5.290443534E+01	-4.819611609E+01	-4.853448223E+01	-4.844460316E+01
2.65E+04	-5.306981656E+01	-4.817198335E+01	-4.850504761E+01	-4.841648240E+01
2.70E+04	-5.323214929E+01	-4.816801380E+01	-4.849581850E+01	-4.840860181E+01
2.75E+04	-5.339146029E+01	-4.818159147E+01	-4.850421858E+01	-4.841835527E+01
2.80E+04	-5.354790982E+01	-4.821051665E+01	-4.852807357E+01	-4.844351302E+01
2.85E+04	-5.370163450E+01	-4.825297593E+01	-4.856552631E+01	-4.848225496E+01
2.90E+04	-5.385264620E+01	-4.830729440E+01	-4.861495808E+01	-4.853293224E+01
2.95E+04	-5.400104280E+01	-4.837212090E+01	-4.867497889E+01	-4.859424214E+01
3.00E+04	-5.414699255E+01	-4.844621912E+01	-4.874441716E+01	-4.866489429E+01
3.05E+04	-5.429052112E+01	-4.852849867E+01	-4.882216701E+01	-4.874384248E+01
3.10E+04	-5.443172207E+01	-4.861811094E+01	-4.890726903E+01	-4.883012509E+01
3.15E+04	-5.457065598E+01	-4.871415359E+01	-4.899896728E+01	-4.892297215E+01
3.20E+04	-5.470736787E+01	-4.881587865E+01	-4.909649480E+01	-4.902161615E+01
3.25E+04	-5.484202683E+01	-4.892276998E+01	-4.919922083E+01	-4.912543555E+01
3.30E+04	-5.497458293E+01	-4.903412834E+01	-4.930657397E+01	-4.923384214E+01
3.35E+04	-5.510515649E+01	-4.914953118E+01	-4.941801088E+01	-4.934633400E+01
3.40E+04	-5.523383867E+01	-4.926848618E+01	-4.953316755E+01	-4.946249899E+01
3.45E+04	-5.536058607E+01	-4.939055562E+01	-4.965153889E+01	-4.958186876E+01
3.50E+04	-5.548554064E+01	-4.951543197E+01	-4.977276043E+01	-4.970404013E+01];

% convert position to metres
beer_H(:,1) = beer_H(:,1) * 1e-3;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%   %%%  dipole antennas  %%%  %%%

%		free space	PEC	PMC	er=4.5 approx	er=4.5 Sommerfeld	er=7.5 approx	er=7.5 Sommerfeld
% 5.000E+02	-3.036101332E+01	-3.032336095E+01	-3.039822880E+01	-3.034839492E+01	-3.034109784E+01	-3.034442000E+01	-3.033562065E+01
dipole_V = [1.000E+03	-3.635217654E+01	-3.688173690E+01	-3.585260420E+01	-3.651850941E+01	-3.657791115E+01	-3.657409581E+01	-3.664528553E+01
1.500E+03	-3.986925920E+01	-4.122508187E+01	-3.867443190E+01	-4.022981212E+01	-4.030310688E+01	-4.037014470E+01	-4.045807706E+01
2.000E+03	-4.236709696E+01	-4.063537615E+01	-4.417285230E+01	-4.195792711E+01	-4.189805649E+01	-4.176975120E+01	-4.169914069E+01
2.500E+03	-4.430500688E+01	-4.149842460E+01	-4.833811329E+01	-4.372727830E+01	-4.365066004E+01	-4.340430860E+01	-4.331803961E+01
3.000E+03	-4.588820962E+01	-4.435783300E+01	-4.563325672E+01	-4.579350775E+01	-4.578946668E+01	-4.567275688E+01	-4.566031015E+01
3.500E+03	-4.722660024E+01	-5.193890700E+01	-4.356101988E+01	-4.756631972E+01	-4.761439441E+01	-4.804453038E+01	-4.810148488E+01
4.000E+03	-4.838598762E+01	-4.431703550E+01	-5.390647481E+01	-4.823536815E+01	-4.818815375E+01	-4.772751688E+01	-4.767353917E+01
4.500E+03	-4.940881080E+01	-5.033703317E+01	-4.603756312E+01	-4.934745143E+01	-4.934440471E+01	-4.964856979E+01	-4.964213340E+01
5.000E+03	-5.032391854E+01	-5.114351935E+01	-4.674106282E+01	-5.017501559E+01	-5.023830343E+01	-5.050967181E+01	-5.057903214E+01
5.500E+03	-5.115177214E+01	-4.623716215E+01	-6.036571355E+01	-5.178640179E+01	-5.174210457E+01	-5.109043968E+01	-5.104216029E+01
6.000E+03	-5.190747719E+01	-4.839911536E+01	-5.160986086E+01	-5.217196190E+01	-5.212260179E+01	-5.194693409E+01	-5.189060789E+01
6.500E+03	-5.260259134E+01	-5.695622031E+01	-4.779410855E+01	-5.166245189E+01	-5.166744369E+01	-5.222905813E+01	-5.223218998E+01
7.000E+03	-5.324616422E+01	-6.010216633E+01	-4.812185809E+01	-5.202256341E+01	-5.206877591E+01	-5.263938761E+01	-5.269604500E+01
7.500E+03	-5.384537143E+01	-5.195380015E+01	-5.089477097E+01	-5.350353598E+01	-5.355818787E+01	-5.370174358E+01	-5.376299217E+01
8.000E+03	-5.440594145E+01	-4.966749100E+01	-5.668983746E+01	-5.569359594E+01	-5.571630113E+01	-5.522134290E+01	-5.524085452E+01
8.500E+03	-5.493252643E+01	-4.937329426E+01	-7.332135740E+01	-5.744415167E+01	-5.740203591E+01	-5.649344092E+01	-5.645041450E+01
9.000E+03	-5.542896594E+01	-5.023716425E+01	-6.007436127E+01	-5.744926414E+01	-5.738896599E+01	-5.680134930E+01	-5.673635807E+01
9.500E+03	-5.589853038E+01	-5.200494583E+01	-5.500304828E+01	-5.638344301E+01	-5.631903525E+01	-5.631896724E+01	-5.624185611E+01
1.000E+04	-5.634400558E+01	-5.470084965E+01	-5.282608605E+01	-5.538875907E+01	-5.535330338E+01	-5.569204303E+01	-5.564445148E+01
1.050E+04	-5.676776873E+01	-5.869842893E+01	-5.186659318E+01	-5.479812648E+01	-5.478263060E+01	-5.527128758E+01	-5.524837940E+01
1.100E+04	-5.717184216E+01	-6.549427145E+01	-5.160077457E+01	-5.460526524E+01	-5.460453839E+01	-5.513944584E+01	-5.513645053E+01
1.150E+04	-5.755794803E+01	-8.147268888E+01	-5.179570751E+01	-5.474449860E+01	-5.475637036E+01	-5.528268616E+01	-5.529703895E+01
1.200E+04	-5.792759422E+01	-6.584470925E+01	-5.233007958E+01	-5.515612010E+01	-5.517799944E+01	-5.566601956E+01	-5.569416830E+01
1.250E+04	-5.828213682E+01	-6.099094898E+01	-5.313696996E+01	-5.579584803E+01	-5.579494020E+01	-5.625596488E+01	-5.625445675E+01
1.300E+04	-5.862277611E+01	-5.845641432E+01	-5.418142304E+01	-5.663311475E+01	-5.663295863E+01	-5.702550858E+01	-5.702466674E+01
1.350E+04	-5.895057360E+01	-5.692623555E+01	-5.545124904E+01	-5.764786544E+01	-5.764853554E+01	-5.795366431E+01	-5.795353343E+01
1.400E+04	-5.926646467E+01	-5.596102785E+01	-5.695466610E+01	-5.882732376E+01	-5.882888431E+01	-5.902318440E+01	-5.902378750E+01
1.450E+04	-5.957126138E+01	-5.535813265E+01	-5.872359149E+01	-6.016217157E+01	-6.016466877E+01	-6.021678685E+01	-6.021810400E+01
1.500E+04	-5.986571103E+01	-5.500668641E+01	-6.082504373E+01	-6.164015580E+01	-6.164357255E+01	-6.151091177E+01	-6.151282961E+01
1.550E+04	-6.015049832E+01	-5.483920919E+01	-6.339015109E+01	-6.323306605E+01	-6.323719433E+01	-6.286512586E+01	-6.286736392E+01
1.600E+04	-6.042625063E+01	-5.481154992E+01	-6.669447949E+01	-6.486987799E+01	-6.487411630E+01	-6.420581783E+01	-6.420779396E+01
1.650E+04	-6.069352481E+01	-5.489325430E+01	-7.144506461E+01	-6.639256362E+01	-6.639555012E+01	-6.540957162E+01	-6.541033287E+01
1.700E+04	-6.095282749E+01	-5.506250225E+01	-8.060167836E+01	-6.753034351E+01	-6.753006655E+01	-6.631059871E+01	-6.630899880E+01
1.750E+04	-6.120460806E+01	-5.530318431E+01	-8.289254161E+01	-6.801084842E+01	-6.800597505E+01	-6.676781670E+01	-6.676317402E+01
1.800E+04	-6.144928480E+01	-5.560318401E+01	-7.356456367E+01	-6.780628266E+01	-6.779757522E+01	-6.676275985E+01	-6.675538303E+01
1.850E+04	-6.168725654E+01	-5.595324065E+01	-6.953017010E+01	-6.716067464E+01	-6.715003538E+01	-6.641206053E+01	-6.640293478E+01
1.900E+04	-6.191888225E+01	-5.634619888E+01	-6.706920614E+01	-6.634961964E+01	-6.633854013E+01	-6.587655420E+01	-6.586667612E+01
1.950E+04	-6.214450463E+01	-5.677648248E+01	-6.537038183E+01	-6.553965529E+01	-6.552889546E+01	-6.528174794E+01	-6.527178805E+01
2.000E+04	-6.236441111E+01	-5.723971415E+01	-6.412163346E+01	-6.480204330E+01	-6.479190295E+01	-6.470055299E+01	-6.469087008E+01
2.050E+04	-6.257888635E+01	-5.773247609E+01	-6.316946944E+01	-6.415784255E+01	-6.414839056E+01	-6.416740736E+01	-6.415815900E+01
2.100E+04	-6.278818655E+01	-5.825214749E+01	-6.242686462E+01	-6.360671543E+01	-6.359792950E+01	-6.369487704E+01	-6.368611661E+01
2.150E+04	-6.299255944E+01	-5.879675900E+01	-6.183962522E+01	-6.314055750E+01	-6.313238931E+01	-6.328460291E+01	-6.327633312E+01
2.200E+04	-6.319223536E+01	-5.936491061E+01	-6.137169234E+01	-6.274927382E+01	-6.274166101E+01	-6.293330482E+01	-6.292549850E+01
2.250E+04	-6.338743589E+01	-5.995568292E+01	-6.099783025E+01	-6.242301124E+01	-6.241590044E+01	-6.263577968E+01	-6.262841154E+01
2.300E+04	-6.357834132E+01	-6.056857705E+01	-6.069969456E+01	-6.215292172E+01	-6.214625570E+01	-6.238637808E+01	-6.237941135E+01
2.350E+04	-6.376513890E+01	-6.120348614E+01	-6.046355670E+01	-6.193134804E+01	-6.192508223E+01	-6.217964170E+01	-6.217303967E+01
2.400E+04	-6.394799785E+01	-6.186068573E+01	-6.027886089E+01	-6.175175533E+01	-6.174585277E+01	-6.201057748E+01	-6.200431357E+01
2.450E+04	-6.412708880E+01	-6.254084972E+01	-6.013733342E+01	-6.160860161E+01	-6.160302581E+01	-6.187474328E+01	-6.186878081E+01
2.500E+04	-6.430256384E+01	-6.324505294E+01	-6.003236449E+01	-6.149717128E+01	-6.149189224E+01	-6.176821231E+01	-6.176253219E+01
2.550E+04	-6.447456866E+01	-6.397480652E+01	-5.995858826E+01	-6.141344936E+01	-6.140844152E+01	-6.168755107E+01	-6.168213456E+01
2.600E+04	-6.464323071E+01	-6.473210240E+01	-5.991161157E+01	-6.135400456E+01	-6.134924481E+01	-6.162976157E+01	-6.162458278E+01
2.650E+04	-6.480867774E+01	-6.551948553E+01	-5.988779202E+01	-6.131590366E+01	-6.131137324E+01	-6.159222345E+01	-6.158726832E+01
2.700E+04	-6.497103003E+01	-6.634015904E+01	-5.988409157E+01	-6.129662751E+01	-6.129230947E+01	-6.157267110E+01	-6.156792110E+01
2.750E+04	-6.513040080E+01	-6.719815552E+01	-5.989795067E+01	-6.129400407E+01	-6.128988139E+01	-6.156911759E+01	-6.156455617E+01
2.800E+04	-6.528690883E+01	-6.809850830E+01	-5.992717716E+01	-6.130614339E+01	-6.130220332E+01	-6.157981638E+01	-6.157542943E+01
2.850E+04	-6.544064408E+01	-6.904758718E+01	-5.996989490E+01	-6.133139058E+01	-6.132762120E+01	-6.160322885E+01	-6.159900545E+01
2.900E+04	-6.559170626E+01	-7.005348885E+01	-6.002447674E+01	-6.136829335E+01	-6.136468531E+01	-6.163798630E+01	-6.163392196E+01
2.950E+04	-6.574018458E+01	-7.112667234E+01	-6.008952678E+01	-6.141558863E+01	-6.141212436E+01	-6.168290107E+01	-6.167898110E+01
3.000E+04	-6.588616498E+01	-7.228090056E+01	-6.016383494E+01	-6.147216198E+01	-6.146883792E+01	-6.173691100E+01	-6.173312932E+01
3.050E+04	-6.602973277E+01	-7.353475841E+01	-6.024635270E+01	-6.153704119E+01	-6.153384800E+01	-6.179909100E+01	-6.179543589E+01
3.100E+04	-6.617097012E+01	-7.491406120E+01	-6.033614876E+01	-6.160935238E+01	-6.160628280E+01	-6.186860644E+01	-6.186507019E+01
3.150E+04	-6.630994641E+01	-7.645619691E+01	-6.043239798E+01	-6.168831942E+01	-6.168536591E+01	-6.194470212E+01	-6.194128374E+01
3.200E+04	-6.644673653E+01	-7.821805548E+01	-6.053436041E+01	-6.177323891E+01	-6.177039477E+01	-6.202670289E+01	-6.202339577E+01
3.250E+04	-6.658139941E+01	-8.029248614E+01	-6.064139630E+01	-6.186349533E+01	-6.186075449E+01	-6.211401090E+01	-6.211080653E+01
3.300E+04	-6.671400720E+01	-8.284671192E+01	-6.075293906E+01	-6.195853874E+01	-6.195589632E+01	-6.220609311E+01	-6.220298534E+01
3.350E+04	-6.684462314E+01	-8.623131096E+01	-6.086849083E+01	-6.205788224E+01	-6.205533403E+01	-6.230247335E+01	-6.229945409E+01
3.400E+04	-6.697330387E+01	-9.140932410E+01	-6.098760171E+01	-6.216108250E+01	-6.215862555E+01	-6.240272297E+01	-6.239979147E+01
3.450E+04	-6.710010874E+01	-1.035437712E+02	-6.110985896E+01	-6.226773505E+01	-6.226535959E+01	-6.250643628E+01	-6.250359062E+01
3.500E+04	-6.722508529E+01	-9.710321937E+01	-6.123488623E+01	-6.237747137E+01	-6.237517769E+01	-6.261325713E+01	-6.261049295E+01];


% conver to metres
dipole_V(:,1) = dipole_V(:,1) * 1e-3;


%%%   %%%  dipole antennas  %%%  %%%

% HORIZONTAL	free space	PEC	PMC	er=4.5 approx	er=7.5 approx
% 5.000E+02	-3.035671673E+01	-3.050213593E+01	-2.975211625E+01	-3.046619130E+01	-3.048564445E+01
dipole_H = [1.000E+03	-3.634784431E+01	-3.339843943E+01	-4.083898942E+01	-3.504906114E+01	-3.473565267E+01
1.500E+03	-3.986492676E+01	-3.616064705E+01	-4.544294751E+01	-3.806727246E+01	-3.768483036E+01
2.000E+03	-4.236276662E+01	-4.585291387E+01	-3.823774313E+01	-4.446173172E+01	-4.485464308E+01
2.500E+03	-4.430067066E+01	-5.418142000E+01	-3.927576227E+01	-4.841371723E+01	-4.941563281E+01
3.000E+03	-4.588387145E+01	-4.455371438E+01	-4.283773033E+01	-4.572067988E+01	-4.553442474E+01
3.500E+03	-4.722225657E+01	-4.228793146E+01	-5.282514482E+01	-4.401134194E+01	-4.361104031E+01
4.000E+03	-4.838164582E+01	-5.484193536E+01	-4.299937257E+01	-5.312933816E+01	-5.373701785E+01
4.500E+03	-4.940447393E+01	-4.522887587E+01	-4.948534567E+01	-4.664835576E+01	-4.631618176E+01
5.000E+03	-5.031958006E+01	-4.604107698E+01	-5.043721304E+01	-4.739406442E+01	-4.707356880E+01
5.500E+03	-5.114743183E+01	-6.160513039E+01	-4.537554042E+01	-5.850227748E+01	-5.946824427E+01
6.000E+03	-5.190313779E+01	-5.123584880E+01	-4.764252057E+01	-5.211206401E+01	-5.193769942E+01
6.500E+03	-5.259824677E+01	-4.739315465E+01	-5.651018746E+01	-4.853506832E+01	-4.824707932E+01
7.000E+03	-5.324182240E+01	-4.777848308E+01	-5.994183691E+01	-4.886750222E+01	-4.859064791E+01
7.500E+03	-5.384103062E+01	-5.061477466E+01	-5.142769394E+01	-5.157295376E+01	-5.134109103E+01
8.000E+03	-5.440160238E+01	-5.650695506E+01	-4.915946882E+01	-5.705067364E+01	-5.698185533E+01
8.500E+03	-5.492818530E+01	-7.779521135E+01	-4.889848500E+01	-6.699382883E+01	-6.892924123E+01
9.000E+03	-5.542462633E+01	-6.002015250E+01	-4.979475120E+01	-6.018152974E+01	-6.022761356E+01
9.500E+03	-5.589418844E+01	-5.488909027E+01	-5.159240551E+01	-5.556854685E+01	-5.540730524E+01
1.000E+04	-5.633966612E+01	-5.272197862E+01	-5.431695218E+01	-5.346072592E+01	-5.326992980E+01
1.050E+04	-5.676342826E+01	-5.177924515E+01	-5.834810558E+01	-5.251271012E+01	-5.231881437E+01
1.100E+04	-5.716749778E+01	-5.153032387E+01	-6.523510019E+01	-5.224186622E+01	-5.205204524E+01
1.150E+04	-5.755360587E+01	-5.174096922E+01	-8.784916387E+01	-5.242531884E+01	-5.224213041E+01
1.200E+04	-5.792325258E+01	-5.228961939E+01	-6.561455650E+01	-5.294504222E+01	-5.276960143E+01
1.250E+04	-5.827779508E+01	-5.310940719E+01	-6.071214877E+01	-5.373527581E+01	-5.356823619E+01
1.300E+04	-5.861843344E+01	-5.416551437E+01	-5.817643462E+01	-5.476125257E+01	-5.460325679E+01
1.350E+04	-5.894623438E+01	-5.544591724E+01	-5.665195706E+01	-5.601027100E+01	-5.586226640E+01
1.400E+04	-5.926212136E+01	-5.695901490E+01	-5.569386836E+01	-5.748916570E+01	-5.735280549E+01
1.450E+04	-5.956692121E+01	-5.873696156E+01	-5.509819695E+01	-5.922683980E+01	-5.910525246E+01
1.500E+04	-5.986136980E+01	-6.084711446E+01	-5.475366116E+01	-6.128349070E+01	-6.118301663E+01
1.550E+04	-6.014615631E+01	-6.342136067E+01	-5.459264978E+01	-6.377268492E+01	-6.370777967E+01
1.600E+04	-6.042190725E+01	-6.673757310E+01	-5.457099148E+01	-6.691375973E+01	-6.692403600E+01
1.650E+04	-6.068918315E+01	-7.151459344E+01	-5.465825246E+01	-7.115383257E+01	-7.138750686E+01
1.700E+04	-6.094848649E+01	-8.090698981E+01	-5.483262618E+01	-7.702849727E+01	-7.834651547E+01
1.750E+04	-6.120026458E+01	-8.339197182E+01	-5.507804061E+01	-7.803168652E+01	-7.958626413E+01
1.800E+04	-6.144494225E+01	-7.366770433E+01	-5.538241511E+01	-7.304428245E+01	-7.333674699E+01
1.850E+04	-6.168291237E+01	-6.960699510E+01	-5.573651308E+01	-6.961546502E+01	-6.966005299E+01
1.900E+04	-6.191454001E+01	-6.714128699E+01	-5.613321939E+01	-6.732953716E+01	-6.729933467E+01
1.950E+04	-6.214015958E+01	-6.544236342E+01	-5.656698069E+01	-6.570026582E+01	-6.563995676E+01
2.000E+04	-6.236007163E+01	-6.419499029E+01	-5.703344109E+01	-6.448358067E+01	-6.440922823E+01
2.050E+04	-6.257454507E+01	-6.324474127E+01	-5.752921130E+01	-6.354699741E+01	-6.346566793E+01
2.100E+04	-6.278384441E+01	-6.250423525E+01	-5.805168183E+01	-6.281167985E+01	-6.272690396E+01
2.150E+04	-6.298821605E+01	-6.191913085E+01	-5.859890351E+01	-6.222715434E+01	-6.214087875E+01
2.200E+04	-6.318789577E+01	-6.145329568E+01	-5.916949855E+01	-6.175925078E+01	-6.167260182E+01
2.250E+04	-6.338309202E+01	-6.108146312E+01	-5.976255716E+01	-6.138377158E+01	-6.129743869E+01
2.300E+04	-6.357400139E+01	-6.078527920E+01	-6.037759082E+01	-6.108298620E+01	-6.099740033E+01
2.350E+04	-6.376079536E+01	-6.055099498E+01	-6.101451085E+01	-6.084352552E+01	-6.075896012E+01
2.400E+04	-6.394365734E+01	-6.036806393E+01	-6.167360150E+01	-6.065508053E+01	-6.057171262E+01
2.450E+04	-6.412274423E+01	-6.022821350E+01	-6.235554390E+01	-6.050953293E+01	-6.042747389E+01
2.500E+04	-6.429822114E+01	-6.012483348E+01	-6.306142397E+01	-6.040038341E+01	-6.031969313E+01
2.550E+04	-6.447022431E+01	-6.005256904E+01	-6.379276041E+01	-6.032234140E+01	-6.024305741E+01
2.600E+04	-6.463889045E+01	-6.000702237E+01	-6.455155024E+01	-6.027106061E+01	-6.019319813E+01
2.650E+04	-6.480433803E+01	-5.998455701E+01	-6.534034867E+01	-6.024293663E+01	-6.016649439E+01
2.700E+04	-6.496668680E+01	-5.998214778E+01	-6.616237094E+01	-6.023495472E+01	-6.015992718E+01
2.750E+04	-6.512606208E+01	-5.999722639E+01	-6.702164716E+01	-6.024457614E+01	-6.017094471E+01
2.800E+04	-6.528256745E+01	-6.002761304E+01	-6.792322201E+01	-6.026962535E+01	-6.019736822E+01
2.850E+04	-6.543630411E+01	-6.007143622E+01	-6.887347314E+01	-6.030822713E+01	-6.023732348E+01
2.900E+04	-6.558736458E+01	-6.012706681E+01	-6.988050501E+01	-6.035876907E+01	-6.028918694E+01
2.950E+04	-6.573584394E+01	-6.019311101E+01	-7.095478410E+01	-6.041985218E+01	-6.035156821E+01
3.000E+04	-6.588182409E+01	-6.026837351E+01	-7.211010323E+01	-6.049027741E+01	-6.042325640E+01
3.050E+04	-6.602539193E+01	-6.035179259E+01	-7.336504952E+01	-6.056899231E+01	-6.050320633E+01
3.100E+04	-6.616662776E+01	-6.044245110E+01	-7.474549989E+01	-6.065506623E+01	-6.059048555E+01
3.150E+04	-6.630560476E+01	-6.053952307E+01	-7.628888442E+01	-6.074767172E+01	-6.068427126E+01
3.200E+04	-6.644239174E+01	-6.064227445E+01	-7.805224614E+01	-6.084607688E+01	-6.078382274E+01
3.250E+04	-6.657705573E+01	-6.075006229E+01	-8.012876152E+01	-6.094963157E+01	-6.088849856E+01
3.300E+04	-6.670966481E+01	-6.086232369E+01	-8.268656742E+01	-6.105777637E+01	-6.099772979E+01
3.350E+04	-6.684027820E+01	-6.097856468E+01	-8.607954854E+01	-6.117000561E+01	-6.111102089E+01
3.400E+04	-6.696896182E+01	-6.109833376E+01	-9.129144940E+01	-6.128586940E+01	-6.122792104E+01
3.450E+04	-6.709576461E+01	-6.122122057E+01	-1.042455856E+02	-6.140494889E+01	-6.134801173E+01
3.500E+04	-6.722074022E+01	-6.134685051E+01	-9.712598764E+01	-6.152687634E+01	-6.147092247E+01];


% conver to metres
dipole_H(:,1) = dipole_H(:,1) * 1e-3;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% graph free space loss cases

figure
plot(dS_c,Lfs_c-max(Lfs_c),'kx')
hold on
plot(dipole_V(:,1),dipole_V(:,2)-dipole_V(1,2),beer_V(:,1),beer_V(:,2)-beer_V(1,2),...
    dipole_H(:,1),dipole_H(:,2)-dipole_H(1,2),beer_H(:,1),beer_H(:,2)-beer_H(1,2),'LineWidth',2)
grid on
xlabel('Position (m)')
ylabel('Normalised RX power (dB)')
axis([0 50 -35 0])
title('free space loss, no gnd')
strlst={'theory','FEKO V - dipole','FEKO V - beer','FEKO H - dipole','FEKO H - beer'};
legend(strlst)

%%%   %%%   %%%   %%%   %%%

% graph theoretical results

figure
plot(dS,Lfs-max(Lfs),'k--',dS,LtriP_44-max(LtriP_44),dS,LtriN_44-max(LtriN_44),'LineWidth',2)
xlabel('Position (m)')
ylabel('Normalised power (dB)')
legend('LOS theory','vertical pol','horizontal pol')  % ,'total')
title('2-ray interference, concrete floor \epsilon_r=4.5')
grid on
axis([0 50 -40 0])


figure
plot(dS,Lfs-max(Lfs),'k--',dS,LtriP_75-max(LtriP_75),dS,LtriN_75-max(LtriN_75),'LineWidth',2)
xlabel('Position (m)')
ylabel('Normalised power (dB)')
legend('LOS theory','vertical pol','horizontal pol')  % ,'total')
title('2-ray interference, concrete floor \epsilon_r=7.5')
grid on
axis([0 50 -40 0])


%%%   %%%   %%%   %%%   %%%

figure
plot(dS,LtriP_44-max(LtriP_44),'k--',...
    dipole_V(:,1),dipole_V(:,5)-dipole_V(1,5),beer_V(:,1),beer_V(:,5)-beer_V(1,5),...
    expt2018a(:,1),expt2018a(:,2)-expt2018a(1,2),expt2018c(:,1),expt2018c(:,2)-expt2018c(1,2),'LineWidth',2)
xlabel('Position (m)')
ylabel('Normalised RX power (dB)')
grid on
axis([0 50 -35 0])
title('\epsilon_r=4.5 vertical')
strlst={'theory','FEKO - dipole','FEKO - beer','expt A','expt C'};
legend(strlst)


figure
plot(dS,LtriN_44-max(LtriN_44),'k--',...
    dipole_H(:,1),dipole_H(:,5)-dipole_H(1,5),beer_H(:,1),beer_H(:,4)-beer_H(1,4),...
    expt2018b(:,1),expt2018b(:,2)-expt2018b(1,2),'LineWidth',2)
xlabel('Position (m)')
ylabel('Normalised RX power (dB)')
grid on
axis([0 50 -35 0])
title('\epsilon_r=4.5 horizontal')
strlst={'theory','FEKO - dipole','FEKO - beer','expt B'};
legend(strlst)


figure
plot(dS,LtriP_75-max(LtriP_75),'k--',...
    dipole_V(:,1),dipole_V(:,7)-dipole_V(1,7),beer_V(:,1),beer_V(:,6)-beer_V(1,6),...
    expt2018a(:,1),expt2018a(:,2)-expt2018a(1,2),expt2018c(:,1),expt2018c(:,2)-expt2018c(1,2),'LineWidth',2)
xlabel('Position (m)')
ylabel('Normalised RX power (dB)')
grid on
axis([0 50 -35 0])
title('\epsilon_r=7.5 vertical')
strlst={'theory','FEKO - dipole','FEKO - beer','expt A','expt C'};
legend(strlst)


figure
plot(dS,LtriN_75-max(LtriN_75),'k--',...
    dipole_H(:,1),dipole_H(:,6)-dipole_H(1,6),beer_H(:,1),beer_H(:,5)-beer_H(1,5),...
    expt2018b(:,1),expt2018b(:,2)-expt2018b(1,2),'LineWidth',2)
xlabel('Position (m)')
ylabel('Normalised RX power (dB)')
grid on
axis([0 50 -35 0])
title('\epsilon_r=7.5 horizontal')
strlst={'theory','FEKO - dipole','FEKO - beer','expt B'};
legend(strlst)






% end of code
