clear
clc

% feko data h_h
feko_data = [
  5.00E+02	-1.875964005E+01	-1.875859515E+01	-1.875927316E+01
1.00E+03	-2.419810213E+01	-2.448725239E+01	-2.443583248E+01
1.50E+03	-2.719239490E+01	-2.773989640E+01	-2.763742032E+01
2.00E+03	-3.212684401E+01	-3.138043301E+01	-3.152886890E+01
2.50E+03	-3.604856132E+01	-3.422267620E+01	-3.456325413E+01
3.00E+03	-3.403838533E+01	-3.435355164E+01	-3.432091893E+01
3.50E+03	-3.207317888E+01	-3.334759071E+01	-3.306061867E+01
4.00E+03	-4.197841524E+01	-3.992564692E+01	-4.039874196E+01
4.50E+03	-3.446360338E+01	-3.559663708E+01	-3.533840863E+01
5.00E+03	-3.516963636E+01	-3.633780797E+01	-3.607016301E+01
5.50E+03	-4.841586949E+01	-4.508803364E+01	-4.584647593E+01
6.00E+03	-3.994965373E+01	-4.054068221E+01	-4.043318594E+01
6.50E+03	-3.616041046E+01	-3.725634041E+01	-3.698678326E+01
7.00E+03	-3.648360722E+01	-3.756157114E+01	-3.729485123E+01
7.50E+03	-3.924823879E+01	-4.017224461E+01	-3.995628980E+01
8.00E+03	-4.502717355E+01	-4.536853975E+01	-4.534972258E+01
8.50E+03	-6.098366506E+01	-5.326721669E+01	-5.465335382E+01
9.00E+03	-4.836577290E+01	-4.824188338E+01	-4.834616085E+01
9.50E+03	-4.331827928E+01	-4.396056439E+01	-4.381451297E+01
1.00E+04	-4.114289527E+01	-4.190131128E+01	-4.171226431E+01
1.05E+04	-4.018182625E+01	-4.095606016E+01	-4.075870316E+01
1.10E+04	-3.991365650E+01	-4.067603688E+01	-4.048024838E+01
1.15E+04	-4.010614243E+01	-4.084671811E+01	-4.065622328E+01
1.20E+04	-4.063815216E+01	-4.135276619E+01	-4.116930636E+01
1.25E+04	-4.144283988E+01	-4.212936430E+01	-4.195392231E+01
1.30E+04	-4.248527242E+01	-4.314177402E+01	-4.297542011E+01
1.35E+04	-4.375320170E+01	-4.437718986E+01	-4.422110511E+01
1.40E+04	-4.525471178E+01	-4.584173094E+01	-4.569807274E+01
1.45E+04	-4.702172897E+01	-4.756318064E+01	-4.743564010E+01
1.50E+04	-4.912113999E+01	-4.959911340E+01	-4.949521381E+01
1.55E+04	-5.168383791E+01	-5.205681370E+01	-5.199330405E+01
1.60E+04	-5.498449826E+01	-5.513638357E+01	-5.515818441E+01
1.65E+04	-5.972627292E+01	-5.920854243E+01	-5.947445883E+01
1.70E+04	-6.881382320E+01	-6.444167254E+01	-6.568788517E+01
1.75E+04	-7.109220551E+01	-6.531399086E+01	-6.673431972E+01
1.80E+04	-6.185034077E+01	-6.103176372E+01	-6.135974373E+01
1.85E+04	-5.782058788E+01	-5.778679846E+01	-5.784596520E+01
1.90E+04	-5.536003192E+01	-5.555989979E+01	-5.553295406E+01
1.95E+04	-5.366087261E+01	-5.395454914E+01	-5.389182682E+01
2.00E+04	-5.241158906E+01	-5.274879185E+01	-5.266889777E+01
2.05E+04	-5.145887959E+01	-5.181736871E+01	-5.172857809E+01
2.10E+04	-5.071571632E+01	-5.108427393E+01	-5.099082774E+01
2.15E+04	-5.012793585E+01	-5.050043119E+01	-5.040467185E+01
2.20E+04	-4.965948359E+01	-5.003234542E+01	-4.993557207E+01
2.25E+04	-4.928508499E+01	-4.965614376E+01	-4.955923154E+01
2.30E+04	-4.898653481E+01	-4.935432593E+01	-4.925778526E+01
2.35E+04	-4.874994867E+01	-4.911365363E+01	-4.901789443E+01
2.40E+04	-4.856485600E+01	-4.892390639E+01	-4.882912028E+01
2.45E+04	-4.842292113E+01	-4.877706309E+01	-4.868335742E+01
2.50E+04	-4.831755333E+01	-4.866652429E+01	-4.857404003E+01
2.55E+04	-4.824343742E+01	-4.858711757E+01	-4.849589684E+01
2.60E+04	-4.819611609E+01	-4.853448223E+01	-4.844460316E+01
2.65E+04	-4.817198335E+01	-4.850504761E+01	-4.841648240E+01
2.70E+04	-4.816801380E+01	-4.849581850E+01	-4.840860181E+01
2.75E+04	-4.818159147E+01	-4.850421858E+01	-4.841835527E+01
2.80E+04	-4.821051665E+01	-4.852807357E+01	-4.844351302E+01
2.85E+04	-4.825297593E+01	-4.856552631E+01	-4.848225496E+01
2.90E+04	-4.830729440E+01	-4.861495808E+01	-4.853293224E+01
2.95E+04	-4.837212090E+01	-4.867497889E+01	-4.859424214E+01
3.00E+04	-4.844621912E+01	-4.874441716E+01	-4.866489429E+01
3.05E+04	-4.852849867E+01	-4.882216701E+01	-4.874384248E+01
3.10E+04	-4.861811094E+01	-4.890726903E+01	-4.883012509E+01
3.15E+04	-4.871415359E+01	-4.899896728E+01	-4.892297215E+01
3.20E+04	-4.881587865E+01	-4.909649480E+01	-4.902161615E+01
3.25E+04	-4.892276998E+01	-4.919922083E+01	-4.912543555E+01
3.30E+04	-4.903412834E+01	-4.930657397E+01	-4.923384214E+01
3.35E+04	-4.914953118E+01	-4.941801088E+01	-4.934633400E+01
3.40E+04	-4.926848618E+01	-4.953316755E+01	-4.946249899E+01
3.45E+04	-4.939055562E+01	-4.965153889E+01	-4.958186876E+01
3.50E+04	-4.951543197E+01	-4.977276043E+01	-4.970404013E+01
];


c = 2.998 * 10^8;
f = 2.45 * 10^9;
pt = 13;

% convert dBm into w
pt = (10^(pt/10))/1000;

distance = feko_data(:,1)./100;

power = feko_data(:,3)

% convert dBm into w
pr = []; 
for i = 1:length(power)
    temp = (10^(power(i)/10))/1000;
    pr = [pr;temp];
end

wave_length = c/f;

feko_gain_v_v = (20*log10(4*pi*distance./wave_length) + ...
10*log10(pr./pt)) /2;

figure(3)
plot(distance, feko_gain_v_v)
title('h\_h feko Gain figure')
xlabel('distance m')
ylabel('Gain dB')

figure(4)
plot(distance, power)
title('h\_h feko Power figure')
xlabel('distance m')
ylabel('Power dBm')

