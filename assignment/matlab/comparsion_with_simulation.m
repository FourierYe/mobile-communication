clear
clc

% measured data v-v
measured_data_v = [
    1	9.24	9.2
    51	-8.65	-8.75
    101	-14.96	-15.3
    151	-18.64	-19.01
    201	-20.16	-20.58
    251	-22.48	-22.69
    301	-24.32	-24.89
    351	-25.87	-26.23
    401	-26.1	-26.74
    451	-27.7	-29
    501	-28.52	-29.23
    551	-31.22	-32.84
    601	-30.77	-31.24
    651	-27.97	-28.54
    701	-29.14	-29.4
    751	-29.52	-30.3
    801	-35.2	-35.58
    851	-36.2	-36.58
    901	-33.22	-33.49
    951	-31.04	-32.78
    1001	-34.02	-34.9
    1051	-29.69	-30.17
    1101	-31.49	-31.88
    1151	-31.64	-31.88
    1201	-32.7	-33.2
    1251	-32.2	-33.84
    1301	-37.09	-38.33
    1351	-34.32	-34.58
    1401	-35.94	-36.48
    1451	-36.7	-37.04
    1501	-43.43	-44.23
    1551	-42.64	-42.96
    1601	-37.74	-38.44
    1651	-47.24	-48.32
    1701	-41.33	-41.86
    1751	-43.26	-43.97
    1801	-40.11	-43.01
    1851	-45.32	-46.47
    1901	-39.7	-40.48
    1951	-42.64	-43.87
    2001	-39.43	-40.3
    2051	-47.01	-47.56
    2101	-39.84	-40.7
    2151	-52.43	-52.9
    2201	-39.7	-40.01
    2251	-39.32	-40.34
    2301	-41	-41.89
    2351	-37.6	-37.85
    2401	-37.43	-37.8
    2451	-39.32	-40.09
    2501	-38	-38.56
    2551	-38.52	-38.7
    2601	-36.51	-36.86
    2651	-45.02	-45.87
    2701	-38.46	-38.57
    2751	-37.32	-32.74
    2801	-40.34	-40.56
    2851	-40.14	-40.79
    2901	-39.62	-39.74
    2951	-36.8	-36.96
    3001	-37.43	-37.73
    3051	-39.01	-39.29
    3101	-36.29	-36.4
    3151	-39.06	-39.32
    3201	-41.03	-41.5
    3251	-37.42	-37.76
    3301	-37.89	-38.24
    3351	-40.07	-40.34
    3401	-37.27	-37.52
    3451	-42.78	-43.17
    3501	-39.89	-40.56
    3551	-40.56	-40.8
    3601	-38.5	-38.76
    3651	-40.17	-40.28
    3701	-40.4	-40.82
    3751	-38.69	-39.02
    3801	-39.27	-39.89
    3851	-36.3	-36.54
    3901	-40.23	-40.52
    3951	-38.19	-38.32
    4001	-37.73	-37.97
    ];

% convert cm into m
distance_v = measured_data_v(:,1)./100;

power_average_v = (measured_data_v(:,2) + measured_data_v(:,3))./2;


% measured data h_h
measured_data_h  = [
    0	9.97	10
    0.5	-8.82	-8.65
    1	-14.56	-14.32
    1.5	-17.01	-16.67
    2	-20.43	-20.26
    2.5	-24.81	-24.11
    3	-24.3	-23.85
    3.5	-22.49	-22.32
    4	-31.68	-30.44
    4.5	-25.62	-25.31
    5	-26.29	-25.53
    5.5	-34.07	-33.21
    6	-27.28	-26.58
    6.5	-27.68	-27.38
    7	-26.65	-26.28
    7.5	-29.72	-29.38
    8	-34.28	-33.82
    8.5	-46.02	-44.82
    9	-34.45	-33.82
    9.5	-30.28	-30.1
    10	-29.78	-29.36
    10.5	-28.93	-28.52
    11	-28.89	-28.18
    11.5	-29.21	-28.81
    12	-31.46	-31.11
    12.5	-33.36	-33.02
    13	-33.16	-32.62
    13.5	-36.11	-35.54
    14	-42.03	-40.62
    14.5	-38.86	-38.42
    15	-42.05	-39.96
    15.5	-46.12	-44.17
    16	-47.38	-41.01
    16.5	-39.86	-38.56
    17	-38.26	-37.65
    17.5	-41.28	-40.21
    18	-51.68	-49.62
    18.5	-40.68	-39.96
    19	-41.08	-40.49
    19.5	-39.86	-38.96
    20	-40.98	-39.85
    20.5	-38.35	-37.76
    21	-41.29	-39.87
    21.5	-47.54	-45.23
    22	-42.97	-41.23
    22.5	-35.06	-34.6
    23	-34.3	-33.95
    23.5	-34.67	-33.95
    24	-38.08	-37.2
    24.5	-40.38	-40.1
    25	-32.38	-31.4
    25.5	-32.28	-31.8
    26	-35.68	-34.97
    26.5	-34.78	-33.12
    27	-34.26	-33.8
    27.5	-37.64	-36.62
    28	-33.48	-33.16
    28.5	-35.36	-34.9
    29	-42.25	-41.37
    29.5	-33.69	-33.31
    30	-36.35	-35.67
    30.5	-54.82	-53.46
    31	-36.02	-35.41
    31.5	-31.33	-30.97
    32	-36.97	-36.12
    32.5	-36.52	-36.15
    33	-48.06	-46.95
    33.5	-36.42	-35.72
    34	-43.96	-42.96
    34.5	-39.34	-38.66
    35	-38.89	-37.96
    35.5	-35.44	-34.87
    36	-40	-39.51
    36.5	-38.85	-38.02
    37	-40.07	-38.65
    37.5	-36.39	-35.96
    38	-34.84	-34.58
    38.5	-33.16	-32.72
    39	-36.05	-35.02
    39.5	-51.05	-49.97
    40	-47.68	-45.25
    
    ];

distance_h  = measured_data_h (:,1);

power_average_h  = (measured_data_h (:,2)+measured_data_h(:,3))./2;

figure(1)
plot(distance_v, power_average_v)
title('measured Received Power figure')
xlabel('distance m')
ylabel('Power dBm')
hold on
plot(distance_h , power_average_h )
grid on
hold on

% feko simulation

feko_v_v_data = [
    5.00E+02	-1.866002141E+01	-1.872335865E+01	-1.871068305E+01
    1.00E+03	-2.546464610E+01	-2.491981645E+01	-2.499924302E+01
    1.50E+03	-2.950620696E+01	-2.855664864E+01	-2.869256294E+01
    2.00E+03	-2.908673179E+01	-3.026334423E+01	-3.009063209E+01
    2.50E+03	-3.003050727E+01	-3.204622796E+01	-3.175134535E+01
    3.00E+03	-3.266620162E+01	-3.405340287E+01	-3.391883020E+01
    3.50E+03	-4.019443711E+01	-3.582167225E+01	-3.627400089E+01
    4.00E+03	-3.272325131E+01	-3.650874394E+01	-3.601175136E+01
    4.50E+03	-3.898508274E+01	-3.760241206E+01	-3.791366423E+01
    5.00E+03	-3.916631001E+01	-3.846593674E+01	-3.875422213E+01
    5.50E+03	-3.457676371E+01	-4.004230617E+01	-3.935208600E+01
    6.00E+03	-3.683878759E+01	-4.038634621E+01	-4.018736082E+01
    6.50E+03	-4.556976844E+01	-3.991581993E+01	-4.047519288E+01
    7.00E+03	-4.788804108E+01	-4.031505621E+01	-4.090947386E+01
    7.50E+03	-4.013384652E+01	-4.181320406E+01	-4.198440824E+01
    8.00E+03	-3.791853926E+01	-4.398737774E+01	-4.349373185E+01
    8.50E+03	-3.765509101E+01	-4.567942498E+01	-4.473302412E+01
    9.00E+03	-3.853871190E+01	-4.564421710E+01	-4.501409058E+01
    9.50E+03	-4.032428661E+01	-4.458866519E+01	-4.453144858E+01
    1.00E+04	-4.304029969E+01	-4.361324124E+01	-4.391715906E+01
    1.05E+04	-4.707702745E+01	-4.304010323E+01	-4.350970725E+01
    1.10E+04	-5.397910438E+01	-4.285978027E+01	-4.338863485E+01
    1.15E+04	-6.844517313E+01	-4.300803001E+01	-4.353999811E+01
    1.20E+04	-5.388080656E+01	-4.342641259E+01	-4.392951806E+01
    1.25E+04	-4.913944529E+01	-4.407141768E+01	-4.452424522E+01
    1.30E+04	-4.664272322E+01	-4.491296439E+01	-4.529749809E+01
    1.35E+04	-4.513110553E+01	-4.593114335E+01	-4.622846065E+01
    1.40E+04	-4.417667552E+01	-4.711343146E+01	-4.729988598E+01
    1.45E+04	-4.358067539E+01	-4.845028866E+01	-4.849442512E+01
    1.50E+04	-4.323396587E+01	-4.992905811E+01	-4.978800252E+01
    1.55E+04	-4.306987952E+01	-5.152041013E+01	-5.113946867E+01
    1.60E+04	-4.304466541E+01	-5.315121456E+01	-5.247389751E+01
    1.65E+04	-4.312819643E+01	-5.466043354E+01	-5.366696549E+01
    1.70E+04	-4.329881227E+01	-5.577668040E+01	-5.455346910E+01
    1.75E+04	-4.354053627E+01	-5.623439786E+01	-5.499598084E+01
    1.80E+04	-4.384138240E+01	-5.601583669E+01	-5.498059225E+01
    1.85E+04	-4.419215839E+01	-5.536694974E+01	-5.462563613E+01
    1.90E+04	-4.458573316E+01	-5.455882410E+01	-5.409031030E+01
    1.95E+04	-4.501649499E+01	-5.375382387E+01	-5.349800516E+01
    2.00E+04	-4.548013285E+01	-5.302128412E+01	-5.292006477E+01
    2.05E+04	-4.597321877E+01	-5.238161454E+01	-5.239021547E+01
    2.10E+04	-4.649321037E+01	-5.183436180E+01	-5.192071212E+01
    2.15E+04	-4.703810840E+01	-5.137144551E+01	-5.151313461E+01
    2.20E+04	-4.760658462E+01	-5.098282340E+01	-5.116409794E+01
    2.25E+04	-4.819769403E+01	-5.065878306E+01	-5.086852283E+01
    2.30E+04	-4.881088105E+01	-5.039052338E+01	-5.062076143E+01
    2.35E+04	-4.944608801E+01	-5.017052307E+01	-5.041549455E+01
    2.40E+04	-5.010364750E+01	-4.999227060E+01	-5.024762002E+01
    2.45E+04	-5.078420897E+01	-4.985024215E+01	-5.011284388E+01
    2.50E+04	-5.148885629E+01	-4.973978600E+01	-5.000720612E+01
    2.55E+04	-5.221911776E+01	-4.965688002E+01	-4.992733811E+01
    2.60E+04	-5.297696866E+01	-4.959812444E+01	-4.987019204E+01
    2.65E+04	-5.376500094E+01	-4.956066694E+01	-4.983326315E+01
    2.70E+04	-5.458640387E+01	-4.954193852E+01	-4.981422410E+01
    2.75E+04	-5.544529339E+01	-4.953979542E+01	-4.981114440E+01
    2.80E+04	-5.634666274E+01	-4.955235318E+01	-4.982224593E+01
    2.85E+04	-5.729697213E+01	-4.957795022E+01	-4.984598505E+01
    2.90E+04	-5.830435467E+01	-4.961514739E+01	-4.988103732E+01
    2.95E+04	-5.937929096E+01	-4.966276282E+01	-4.992624534E+01
    3.00E+04	-6.053569320E+01	-4.971959620E+01	-4.998050163E+01
    3.05E+04	-6.179228042E+01	-4.978469334E+01	-5.004289726E+01
    3.10E+04	-6.317510896E+01	-4.985719789E+01	-5.011258649E+01
    3.15E+04	-6.472190323E+01	-4.993631277E+01	-5.018884293E+01
    3.20E+04	-6.649023472E+01	-5.002137281E+01	-5.027097712E+01
    3.25E+04	-6.857420553E+01	-5.011176158E+01	-5.035844839E+01
    3.30E+04	-7.114370335E+01	-5.020696602E+01	-5.045062803E+01
    3.35E+04	-7.455660126E+01	-5.030640828E+01	-5.054712221E+01
    3.40E+04	-7.980400429E+01	-5.040972027E+01	-5.064749584E+01
    3.45E+04	-9.227183769E+01	-5.051643489E+01	-5.075122830E+01
    3.50E+04	-8.501155450E+01	-5.062621525E+01	-5.085813617E+01
    ];

feko_v_v_distance = feko_v_v_data(:,1)./1000;

feko_v_v_power = feko_v_v_data (:,3);

plot(feko_v_v_distance, feko_v_v_power);

hold on

feko_h_h_data = [
    5.00E+02	-1.875964005E+01	-1.875859515E+01	-1.875927316E+01
    1.00E+03	-2.419810213E+01	-2.448725239E+01	-2.443583248E+01
    1.50E+03	-2.719239490E+01	-2.773989640E+01	-2.763742032E+01
    2.00E+03	-3.212684401E+01	-3.138043301E+01	-3.152886890E+01
    2.50E+03	-3.604856132E+01	-3.422267620E+01	-3.456325413E+01
    3.00E+03	-3.403838533E+01	-3.435355164E+01	-3.432091893E+01
    3.50E+03	-3.207317888E+01	-3.334759071E+01	-3.306061867E+01
    4.00E+03	-4.197841524E+01	-3.992564692E+01	-4.039874196E+01
    4.50E+03	-3.446360338E+01	-3.559663708E+01	-3.533840863E+01
    5.00E+03	-3.516963636E+01	-3.633780797E+01	-3.607016301E+01
    5.50E+03	-4.841586949E+01	-4.508803364E+01	-4.584647593E+01
    6.00E+03	-3.994965373E+01	-4.054068221E+01	-4.043318594E+01
    6.50E+03	-3.616041046E+01	-3.725634041E+01	-3.698678326E+01
    7.00E+03	-3.648360722E+01	-3.756157114E+01	-3.729485123E+01
    7.50E+03	-3.924823879E+01	-4.017224461E+01	-3.995628980E+01
    8.00E+03	-4.502717355E+01	-4.536853975E+01	-4.534972258E+01
    8.50E+03	-6.098366506E+01	-5.326721669E+01	-5.465335382E+01
    9.00E+03	-4.836577290E+01	-4.824188338E+01	-4.834616085E+01
    9.50E+03	-4.331827928E+01	-4.396056439E+01	-4.381451297E+01
    1.00E+04	-4.114289527E+01	-4.190131128E+01	-4.171226431E+01
    1.05E+04	-4.018182625E+01	-4.095606016E+01	-4.075870316E+01
    1.10E+04	-3.991365650E+01	-4.067603688E+01	-4.048024838E+01
    1.15E+04	-4.010614243E+01	-4.084671811E+01	-4.065622328E+01
    1.20E+04	-4.063815216E+01	-4.135276619E+01	-4.116930636E+01
    1.25E+04	-4.144283988E+01	-4.212936430E+01	-4.195392231E+01
    1.30E+04	-4.248527242E+01	-4.314177402E+01	-4.297542011E+01
    1.35E+04	-4.375320170E+01	-4.437718986E+01	-4.422110511E+01
    1.40E+04	-4.525471178E+01	-4.584173094E+01	-4.569807274E+01
    1.45E+04	-4.702172897E+01	-4.756318064E+01	-4.743564010E+01
    1.50E+04	-4.912113999E+01	-4.959911340E+01	-4.949521381E+01
    1.55E+04	-5.168383791E+01	-5.205681370E+01	-5.199330405E+01
    1.60E+04	-5.498449826E+01	-5.513638357E+01	-5.515818441E+01
    1.65E+04	-5.972627292E+01	-5.920854243E+01	-5.947445883E+01
    1.70E+04	-6.881382320E+01	-6.444167254E+01	-6.568788517E+01
    1.75E+04	-7.109220551E+01	-6.531399086E+01	-6.673431972E+01
    1.80E+04	-6.185034077E+01	-6.103176372E+01	-6.135974373E+01
    1.85E+04	-5.782058788E+01	-5.778679846E+01	-5.784596520E+01
    1.90E+04	-5.536003192E+01	-5.555989979E+01	-5.553295406E+01
    1.95E+04	-5.366087261E+01	-5.395454914E+01	-5.389182682E+01
    2.00E+04	-5.241158906E+01	-5.274879185E+01	-5.266889777E+01
    2.05E+04	-5.145887959E+01	-5.181736871E+01	-5.172857809E+01
    2.10E+04	-5.071571632E+01	-5.108427393E+01	-5.099082774E+01
    2.15E+04	-5.012793585E+01	-5.050043119E+01	-5.040467185E+01
    2.20E+04	-4.965948359E+01	-5.003234542E+01	-4.993557207E+01
    2.25E+04	-4.928508499E+01	-4.965614376E+01	-4.955923154E+01
    2.30E+04	-4.898653481E+01	-4.935432593E+01	-4.925778526E+01
    2.35E+04	-4.874994867E+01	-4.911365363E+01	-4.901789443E+01
    2.40E+04	-4.856485600E+01	-4.892390639E+01	-4.882912028E+01
    2.45E+04	-4.842292113E+01	-4.877706309E+01	-4.868335742E+01
    2.50E+04	-4.831755333E+01	-4.866652429E+01	-4.857404003E+01
    2.55E+04	-4.824343742E+01	-4.858711757E+01	-4.849589684E+01
    2.60E+04	-4.819611609E+01	-4.853448223E+01	-4.844460316E+01
    2.65E+04	-4.817198335E+01	-4.850504761E+01	-4.841648240E+01
    2.70E+04	-4.816801380E+01	-4.849581850E+01	-4.840860181E+01
    2.75E+04	-4.818159147E+01	-4.850421858E+01	-4.841835527E+01
    2.80E+04	-4.821051665E+01	-4.852807357E+01	-4.844351302E+01
    2.85E+04	-4.825297593E+01	-4.856552631E+01	-4.848225496E+01
    2.90E+04	-4.830729440E+01	-4.861495808E+01	-4.853293224E+01
    2.95E+04	-4.837212090E+01	-4.867497889E+01	-4.859424214E+01
    3.00E+04	-4.844621912E+01	-4.874441716E+01	-4.866489429E+01
    3.05E+04	-4.852849867E+01	-4.882216701E+01	-4.874384248E+01
    3.10E+04	-4.861811094E+01	-4.890726903E+01	-4.883012509E+01
    3.15E+04	-4.871415359E+01	-4.899896728E+01	-4.892297215E+01
    3.20E+04	-4.881587865E+01	-4.909649480E+01	-4.902161615E+01
    3.25E+04	-4.892276998E+01	-4.919922083E+01	-4.912543555E+01
    3.30E+04	-4.903412834E+01	-4.930657397E+01	-4.923384214E+01
    3.35E+04	-4.914953118E+01	-4.941801088E+01	-4.934633400E+01
    3.40E+04	-4.926848618E+01	-4.953316755E+01	-4.946249899E+01
    3.45E+04	-4.939055562E+01	-4.965153889E+01	-4.958186876E+01
    3.50E+04	-4.951543197E+01	-4.977276043E+01	-4.970404013E+01
    
    ];


feko_h_h_distance = feko_h_h_data(:,1)./1000;

feko_h_h_power = feko_h_h_data (:,4);

plot(feko_h_h_distance, feko_h_h_power);

legend('v-v measured data','h-h measured data','v-v simulation 7.5','h-h simulation 7.5')

axis([0,35,-70,10])